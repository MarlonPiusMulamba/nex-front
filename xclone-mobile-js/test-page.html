<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frontend Diagnostic Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
        }

        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        pre {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }

        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }

        button:hover {
            background: #0056b3;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üîç Frontend Diagnostic Test</h1>

        <div id="results"></div>

        <button onclick="runTests()">Run Diagnostics</button>
        <button onclick="window.location.href='http://localhost:5173'">Open Main App</button>
        <button onclick="checkConsole()">Check Console Errors</button>
    </div>

    <script>
        const results = document.getElementById('results');

        function addResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = message;
            results.appendChild(div);
        }

        function clearResults() {
            results.innerHTML = '';
        }

        async function runTests() {
            clearResults();
            addResult('<h3>Running Diagnostics...</h3>', 'info');

            // Test 1: Check if dev server is running
            try {
                const response = await fetch('http://localhost:5173');
                if (response.ok) {
                    addResult('‚úÖ Dev server is running on port 5173', 'success');
                } else {
                    addResult(`‚ö†Ô∏è Dev server responded with status: ${response.status}`, 'error');
                }
            } catch (e) {
                addResult(`‚ùå Cannot connect to dev server: ${e.message}`, 'error');
            }

            // Test 2: Check API connectivity
            const apiUrl = 'https://nexxback.pythonanywhere.com';
            try {
                const response = await fetch(`${apiUrl}/api/health`, { method: 'GET' });
                if (response.ok) {
                    addResult(`‚úÖ Backend API is reachable at ${apiUrl}`, 'success');
                } else {
                    addResult(`‚ö†Ô∏è Backend API responded with status: ${response.status}`, 'error');
                }
            } catch (e) {
                addResult(`‚ùå Cannot connect to backend API: ${e.message}`, 'error');
            }

            // Test 3: Check localStorage
            try {
                const userId = localStorage.getItem('userId');
                const username = localStorage.getItem('username');
                if (userId) {
                    addResult(`‚úÖ User logged in: ${username} (ID: ${userId})`, 'success');
                } else {
                    addResult('‚ÑπÔ∏è No user logged in (localStorage empty)', 'info');
                }
            } catch (e) {
                addResult(`‚ùå localStorage error: ${e.message}`, 'error');
            }

            // Test 4: Check browser compatibility
            const checks = {
                'ES6 Support': () => eval('() => {}'),
                'Fetch API': () => typeof fetch !== 'undefined',
                'localStorage': () => typeof localStorage !== 'undefined',
                'WebSocket': () => typeof WebSocket !== 'undefined',
                'Promise': () => typeof Promise !== 'undefined'
            };

            for (const [name, check] of Object.entries(checks)) {
                try {
                    if (check()) {
                        addResult(`‚úÖ ${name} supported`, 'success');
                    } else {
                        addResult(`‚ùå ${name} not supported`, 'error');
                    }
                } catch (e) {
                    addResult(`‚ùå ${name} check failed: ${e.message}`, 'error');
                }
            }

            addResult('<h3>Diagnostics Complete</h3>', 'info');
        }

        function checkConsole() {
            addResult('<h3>Console Errors</h3>', 'info');
            addResult('Please open the browser console (F12) and check for errors there.', 'info');
            addResult('Common issues to look for:', 'info');
            addResult('- Module import errors<br>- Component registration errors<br>- Router errors<br>- API connection errors', 'info');
        }

        // Auto-run on load
        window.addEventListener('load', runTests);
    </script>
</body>

</html>